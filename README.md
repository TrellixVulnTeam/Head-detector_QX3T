# Head-detector

### Тренировка модели
1) Установить TensorFlow 2 Object Detection API
2) Скопировать в папку в проектом директорию "research" https://github.com/tensorflow/models/tree/master/research
3) Собрать в одной папке размеченные картинки и их XML и указать путь в ней (path_to_imgs_xml)
4) Выбрать нужную модель отсюда https://github.com/tensorflow/models/blob/master/research/object_detection/g3doc/tf2_detection_zoo.md и скопировать ссылку в код программы(Можно указать свое собсвенное имя, или имя будет присвоено исходя из названия самой модели.
5) Если в XML файлах не содержится информация а размере вписать в переменные width и height размеры картинок(для разлинчых размеров вероятно не будет работать). Если размеры есть в XML то вписать None
6) Указать название папки куда будут сохраняться тренировные данные(train_data_folder)
7) ckpt_file = ckpt-n, где n номер checkpoint, с которого закончиться тренировка, создаются каждые 1000 шагов. Сам файл находится в  ..../Project_folder/pretrained_models/model_name/checpoints
8) Установить параметры тренировки (количесво шагов суммарное если запускать с ckpt-10 и поставить num_steps = 20000 будет сделано 20000-10000 шагов)
9) Зпустить программу. В консоли появится команда, которую нужно ввести для запуска тренировки. Будет много чего писать, это нормально 
10) После выполнения в train_data_folder csv файл со всеми метками, label_map - словарь классов, и .records датасет в формате TFRecords

### Разметка видео
1) Скопировать 2 файла нужного checpoints в ..../Project_folder/pretrained_models/model_name/checpoints
2) Указать названия видео, используемой модели, нужного checkpoint. Установить порог
3) Запустить
